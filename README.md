# Table
Тема №5 Приложение за работа с електронни таблици
В рамките на този проект трябва да се реализира конзолно приложение, което работи с електронни таблици.
Представяне на данните
Данните на една таблица се записват в текстов файл по следния начин:


1.	Всеки ред във файла представя отделен ред в таблицата.
2.	Всеки ред във файла съдържа данни, разделени със запетаи. Тези данни се интерпретират като стойности в клетките на реда.
3.	Всеки ред в таблицата може да съдържа различен брой клетки, затова и всеки ред във файла може да съдържа различен брой елементи, разделени със запетаи.
4.	Празен ред във файла представя празен ред в таблицата (т.е. ред, в който всички клетки са празни).
5.	Между две запетаи във файла може да няма никакви данни. По този начин се представя празна клетка.
6.	Между данните и запетаите може да има произволен брой празни символи (whitespace).

Така за една таблица може да има различни представяния. Например таблицата:

10	20	30	40
 	 	 	 
10	 	1000	 
 	 	 	 
 	10	 	 

може да се представи по следните начини (възможни са и други представяния):

10, 20, 30, 40

10,,1000,
,,,
,10	10, 20 , 30  , 40

10,	, 1000,
  ,    , 	,
  , 10
Типове данни в таблицата
Всяка клетка в таблицата има тип, като в една таблица може да има едновременно клетки от различни типове. Вашето приложение трябва да може да поддържа следните типове:

Цяло число – поредица от цифри, без никакви други символи между тях. В началото на числото може да има знак '+' или '-'. 
Например: 123; -123; +123.

Дробно число – поредица от цифри, следвана от символ за точка и след нея друга поредица от цифри. В началото на числото може да има знак '+' или '-'.
Например: 123.456; -123.456; +123.456.

Символен низ (стринг) – поредица от произволни символи, оградени в кавички. Подобно на низовете в C++, ако в даден низ трябва да бъде включен символа за кавичка, то той трябва да бъде представен като \". За да бъде включена наклонена черта, тя трябва да бъде представена като \\.
Например: "Hello world!"; "C:\\temp\\"; "\"This is a quotation\"".

Формула – формулата винаги започва със символ за равенство. В нея могат да участват следните операции: събиране (+), изваждане (-), умножение (*), деление (/), сравнение (==, !=, <, >, <= или >=). Във формулата могат да участват или числа, или препратки към клетки в таблицата. Ако във формулата участва препратка към клетка, на това място в изчислението трябва да се използва стойността изчислена за дадената клетка. Повече информация за формулите е дадена по-долу.
Нужна функционалност
Програмата трябва да може да зарежда (open), записва (save, save as) и затваря (close) една таблица. 

След като приложението отвори даден файл, то трябва да може да:
•	извежда съдържанието на таблицата на екрана (print);
•	редактира съдържанието на дадена клетка (edit),
Ако при зареждането на данните, приложението ви открие грешка, то трябва да изведе подходящо съобщение за грешка. Съобщението трябва да подскаже на потребителя какво не е наред във входните данни. 
Например:
•	Ако липсва запетая, трябва да се изведе на кой ред и след кой символ липсва запетая.
•	Ако съдържанието на дадена клетка е от неизвестен тип, трябва да се изведе на кой ред и коя колона е клетката и какво точно е некоректното съдържание.
Извеждане на таблицата на екрана
> print

Командата print се използва за извеждане на заредената таблица на стандартния изход. Данните в колоните трябва да се подравнят. Между отделните колони трябва да се поставят символи за отвесна черта (|). 
По-долу е даден пример за входен файл и възможно негово извеждане:

Входен файл	Извеждане
10, "Hello world!", 123.56
"\"Quoted\""
1, 2, 3, 4	10       | Hello world! | 123.56 |   |
"Quoted" |              |        |   |
1        |            2 |      3 | 4 |

Редактиране на клетки    
> edit <row> <column> <new_value>

Командата edit трябва да позволява (с подходящи параметри) на потребителя да променя стойностите на отделните клетки. Това става като се укажат редът и колоната на клетката, която трябва да бъде променена, а също и каква стойност да се запише в нея. Потребителят може да въведе произволен тип данни, който се поддържа от програма (например цяло число, дробно число, низ, формула и т.н.).

Ако потребителят въведе неправилни данни, приложението не трябва да променя нищо в таблицата, а само да изведе на стандартния изход подходящо съобщение за грешка. Забележка! Командата може да промени типа на указаната клетка.
Формули
Номерата на редовете и клетките в таблицата започват от 1. Препратка към ред <N> и колона <M> в таблицата се записва така: R<N>C<M>. Например клетката в ред 10 и колона 5 се представя като R10C5.

Като аргументи в дадена формула могат да участват единствено:


1.	Литерали: цели или дробни числа.
2.	Препратки към произволни типове клетки.

При операциите важат следните правила:


1.	Ако в дадена формула участват само числа, то операцията се извършва по традиционните правила на аритметиката. Логическите операции се оценяват като 0 или 1. Специален случай е делене на две цели числа. В този случай не бива да губите остатъка и резултатът трябва да бъде дробно число (например 1 делено на 2 дава резултат 0.5).
2.	Ако в дадена формула участва низ, той трябва да се преобразува до число. Това става по следния начин. Ако низът съдържа само цифри или поредица от цифри, символ точка и друга поредица от цифри, той се конвертира до съответното число. Всички други низове се конвертират до нула.
Например:

Низ	Конвертирана стойност
“123”	123
“123.456.789”	0
“123.456”	123.456
“Hello world”	0
“123abc”	0


3.	Ако в дадена формула участва празна клетка, тя се конвертира до нула. Това важи и за клетки, чиито координати надхвърлят размерите на таблицата.
4.	Ако в дадена формула има грешка (например делене на нула), приложението не трябва да прекъсва своето изпълнение. Вместо това, когато таблицата се извежда на стандартния изход, в съответната клетка се извежда ERROR, вместо получен резултат.

Нека е дадена примерна таблица, в която клетките в жълт цвят са от тип число, а клетките в зелено са от тип символен низ.

 	Колона 1	Колона 2	Колона 3
Ред 1	10	Hello world!	123.56
Ред 2	123	 	 

По-долу са дадени формули, които се оценяват в примерната таблица по-горе. За всяка формула е дадена и нейната оценка:

Формула в клетката	Реално извършена сметка	Стойност на клетката	Коментар
= 10 + 10	10 + 10	20	 
= R1C1 + R1C3	10 + 123.56	133.56	 
= R1C1 * R1C2	10 * 0	0	„Hello world!“ се преобразува до нула
= R1C1 == R1C2	10 == 0	0	„Hello world!“ се преобразува до нула
= R1C1 <= R2C1	10 <= 123	1	Низът „123“ се преобразува до 123.
= R1C1 * R2C1	10 * 123	1230	Низът „123“ се преобразува до 123.
= R1C1 * R2C2	10 * 0	0	Клетката на ред 2, колона 2 е празна
= R1C1 * R200C1	10 * 0	0	В таблицата няма ред 200 и колона 200. Счита се, че тя е празна.
= 10 / 0	10 / 0	ERROR	 
= 10 / R1C2	10 / 0	ERROR	 
= R1C1 / R1C2	10 / 0	ERROR	 

